<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  提示工程模式
  #

基于全面的[
  即时工程指南](
  https://www.kaggle.com/whitepaper-prompt-engineering) ，我们将对即时工程技术进行实际应用。该指南涵盖了有效即时工程的理论、原则和模式，并演示了如何使用 Spring AI 流畅的 [
  ChatClient API](../chatclient.html) 将这些概念转化为可运行的 Java 代码。本文中使用的演示源代码可在以下位置获取： [
  即时工程模式示例](
  https://github.com/spring-projects/spring-ai-examples/tree/main/prompt-engineering/prompt-engineering-patterns) 。

  1.配置
  #

配置部分概述了如何使用 Spring AI 设置和调整大型语言模型 (LLM)。它涵盖了如何根据用例选择合适的 LLM 提供程序，以及如何配置重要的生成参数，以控制模型输出的质量、样式和格式。

  法学硕士（LLM）提供商选择
  #

为了快速进行工程设计，您需要先选择一个模型。Spring AI 支持[
  多个 LLM 提供商](comparison.html) （例如 OpenAI、Anthropic、Google Vertex AI、AWS Bedrock、Ollama 等），让您无需更改应用程序代码即可切换提供商 - 只需更新配置即可。只需添加所选的启动依赖项 spring-ai-starter-model-&lt;MODEL-PROVIDER-NAME&gt; 即可。例如，以下是如何启用 Anthropic Claude API：
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;
    &lt;artifactId&gt;spring-ai-starter-model-anthropic&lt;/artifactId&gt;
&lt;/dependency&gt;
您可以像这样指定 LLM 模型名称：
.options(ChatOptions.builder()
        .model(&#34;claude-3-7-sonnet-latest&#34;)  // Use Anthropic&#39;s Claude model
        .build())
在[
  参考文档](../chatmodel.html)中查找有关启用每个模型的详细信息。

  LLM 输出配置
  #


  
在深入研究即时工程技术之前，我们有必要了解如何配置 LLM 的输出行为。Spring AI 提供了多个配置选项，可让您通过 [
  ChatOptions](../chatmodel.html#_chat_options) 构建器控制生成的各个方面。">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://studyllm.github.io/docs/%E6%8C%87%E5%8D%97/%E6%8F%90%E7%A4%BA%E5%B7%A5%E7%A8%8B%E6%A8%A1%E5%BC%8F/">
  <meta property="og:site_name" content="Spring AI 1.0.0">
  <meta property="og:title" content="提示工程模式">
  <meta property="og:description" content="提示工程模式 # 基于全面的[ 即时工程指南]( https://www.kaggle.com/whitepaper-prompt-engineering) ，我们将对即时工程技术进行实际应用。该指南涵盖了有效即时工程的理论、原则和模式，并演示了如何使用 Spring AI 流畅的 [ ChatClient API](../chatclient.html) 将这些概念转化为可运行的 Java 代码。本文中使用的演示源代码可在以下位置获取： [ 即时工程模式示例]( https://github.com/spring-projects/spring-ai-examples/tree/main/prompt-engineering/prompt-engineering-patterns) 。
1.配置 # 配置部分概述了如何使用 Spring AI 设置和调整大型语言模型 (LLM)。它涵盖了如何根据用例选择合适的 LLM 提供程序，以及如何配置重要的生成参数，以控制模型输出的质量、样式和格式。
法学硕士（LLM）提供商选择 # 为了快速进行工程设计，您需要先选择一个模型。Spring AI 支持[ 多个 LLM 提供商](comparison.html) （例如 OpenAI、Anthropic、Google Vertex AI、AWS Bedrock、Ollama 等），让您无需更改应用程序代码即可切换提供商 - 只需更新配置即可。只需添加所选的启动依赖项 spring-ai-starter-model-&lt;MODEL-PROVIDER-NAME&gt; 即可。例如，以下是如何启用 Anthropic Claude API：
&lt;dependency&gt; &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt; &lt;artifactId&gt;spring-ai-starter-model-anthropic&lt;/artifactId&gt; &lt;/dependency&gt; 您可以像这样指定 LLM 模型名称：
.options(ChatOptions.builder() .model(&#34;claude-3-7-sonnet-latest&#34;) // Use Anthropic&#39;s Claude model .build()) 在[ 参考文档](../chatmodel.html)中查找有关启用每个模型的详细信息。
LLM 输出配置 # 在深入研究即时工程技术之前，我们有必要了解如何配置 LLM 的输出行为。Spring AI 提供了多个配置选项，可让您通过 [ ChatOptions](../chatmodel.html#_chat_options) 构建器控制生成的各个方面。">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>提示工程模式 | Spring AI 1.0.0</title>
<link rel="icon" href="../../../favicon.png" >
<link rel="manifest" href="../../../manifest.json">
<link rel="canonical" href="https://studyllm.github.io/docs/%E6%8C%87%E5%8D%97/%E6%8F%90%E7%A4%BA%E5%B7%A5%E7%A8%8B%E6%A8%A1%E5%BC%8F/">
<link rel="stylesheet" href="../../../book.min.e9f68c3fff3d8236a489d16a9caf6de5e4d1a29c20eb4b5524e42cd30be4d319.css" integrity="sha256-6faMP/89gjakidFqnK9t5eTRopwg60tVJOQs0wvk0xk=" crossorigin="anonymous">
  <script defer src="../../../fuse.min.js"></script>
  <script defer src="../../../en.search.min.71e7e6c2939a8c322f56321bb68fc2082c0a37b8656d9a9617fd1c6ebfbb4f37.js" integrity="sha256-cefmwpOajDIvVjIbto/CCCwKN7hlbZqWF/0cbr&#43;7Tzc=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="../../../"><span>Spring AI 1.0.0</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ab79ee7c06b73ed1cac487be78704b1a" class="toggle"  />
    <label for="section-ab79ee7c06b73ed1cac487be78704b1a" class="flex justify-between">
      <a href="../../../docs/%E4%BB%8B%E7%BB%8D/" class="">介绍</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E4%BB%8B%E7%BB%8D/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%A6%82%E5%BF%B5/" class="">人工智能概念</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%85%A5%E9%97%A8/" class="">入门</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3dfc9cb1c6958c0db8147e1932e4b22d" class="toggle"  />
    <label for="section-3dfc9cb1c6958c0db8147e1932e4b22d" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/" class="">参考</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-861f1f33bc8d3da259fc08a7bd3778e9" class="toggle"  />
    <label for="section-861f1f33bc8d3da259fc08a7bd3778e9" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E8%81%8A%E5%A4%A9%E5%AE%A2%E6%88%B7%E7%AB%AF-api/" class="">聊天客户端 API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E8%81%8A%E5%A4%A9%E5%AE%A2%E6%88%B7%E7%AB%AF-api/%E9%A1%BE%E9%97%AE-api/" class="">顾问 API</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%8F%90%E7%A4%BA/" class="">提示</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%BB%93%E6%9E%84%E5%8C%96%E8%BE%93%E5%87%BA%E8%BD%AC%E6%8D%A2%E5%99%A8/" class="">结构化输出转换器</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E5%A4%9A%E6%A8%A1%E6%80%81-api/" class="">多模态 API</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f78b15e57dfff314304a2bb1e9884f4a" class="toggle"  />
    <label for="section-f78b15e57dfff314304a2bb1e9884f4a" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/" class="">模型</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f01f599500243d0a36d315cf18df347c" class="toggle"  />
    <label for="section-f01f599500243d0a36d315cf18df347c" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/" class="">聊天模型 API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B%E6%AF%94%E8%BE%83/" class="">聊天模型比较</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%9F%BA%E5%B2%A9-converse/" class="">亚马逊基岩 Converse</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/%E4%BA%BA%E7%B1%BB%E5%AD%A6-3-%E8%81%8A%E5%A4%A9/" class="">人类学 3 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/azure-openai-%E8%81%8A%E5%A4%A9/" class="">Azure OpenAI 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/deepseek-%E8%81%8A%E5%A4%A9/" class="">DeepSeek 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/docker-%E6%A8%A1%E5%9E%8B%E8%BF%90%E8%A1%8C%E8%80%85%E8%81%8A%E5%A4%A9/" class="">Docker 模型运行者聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-810d79b9e4561cb82f174a0a980239af" class="toggle"  />
    <label for="section-810d79b9e4561cb82f174a0a980239af" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/google-vertexai/" class="">Google VertexAI</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/google-vertexai/vertexai-gemini-%E8%81%8A%E5%A4%A9/" class="">VertexAI Gemini 聊天</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/groq-%E8%81%8A%E5%A4%A9/" class="">Groq 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/%E6%8B%A5%E6%8A%B1%E8%84%B8%E8%81%8A%E5%A4%A9/" class="">拥抱脸聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/mistral-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E8%81%8A%E5%A4%A9/" class="">Mistral 人工智能聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/minimax-%E8%81%8A%E5%A4%A9/" class="">MiniMax 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/moonshot-ai-%E8%81%8A%E5%A4%A9/" class="">Moonshot AI 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/nvidia-%E8%81%8A%E5%A4%A9/" class="">NVIDIA 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/%E8%81%8A%E5%A4%A9/" class="">聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/%E5%9B%B0%E6%83%91%E8%81%8A%E5%A4%A9/" class="">困惑聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-99bf04ea1225435ee3d3aac878598d1b" class="toggle"  />
    <label for="section-99bf04ea1225435ee3d3aac878598d1b" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/oci-%E7%94%9F%E6%88%90%E5%BC%8F-ai/" class="">OCI 生成式 AI</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/oci-%E7%94%9F%E6%88%90%E5%BC%8F-ai/oci-genai-%E5%8D%8F%E5%90%8C%E8%81%8A%E5%A4%A9/" class="">OCI GenAI 协同聊天</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/openai-%E8%81%8A%E5%A4%A9/" class="">OpenAI 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/%E5%8D%83%E5%B8%86%E8%81%8A%E5%A4%A9/" class="">千帆聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E8%81%8A%E5%A4%A9%E6%A8%A1%E5%9E%8B-api/%E6%99%BA%E6%B5%A6-ai-%E8%81%8A%E5%A4%A9/" class="">智浦 AI 聊天</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-402a989be78a917606348d6ff6652ff7" class="toggle"  />
    <label for="section-402a989be78a917606348d6ff6652ff7" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/" class="">嵌入模型 API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-56d4fbd63aba9093164f2784fdd04677" class="toggle"  />
    <label for="section-56d4fbd63aba9093164f2784fdd04677" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%9F%BA%E5%B2%A9/" class="">亚马逊基岩</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%9F%BA%E5%B2%A9/%E7%9B%B8%E5%B9%B2%E5%B5%8C%E5%85%A5/" class="">相干嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/%E4%BA%9A%E9%A9%AC%E9%80%8A%E5%9F%BA%E5%B2%A9/%E6%B3%B0%E5%9D%A6%E5%B5%8C%E5%85%A5/" class="">泰坦嵌入</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/azure-openai-%E5%B5%8C%E5%85%A5/" class="">Azure OpenAI 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/mistral-ai-%E5%B5%8C%E5%85%A5/" class="">Mistral AI 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/minimax-%E8%81%8A%E5%A4%A9/" class="">MiniMax 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/oracle-%E4%BA%91%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-oci-genai-%E5%B5%8C%E5%85%A5/" class="">Oracle 云基础设施 (OCI) GenAI 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/ollama-%E5%B5%8C%E5%85%A5/" class="">Ollama 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/transformersonnx%E5%B5%8C%E5%85%A5/" class="">Transformers（ONNX）嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/openai-%E5%B5%8C%E5%85%A5/" class="">OpenAI 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/postgresml-%E5%B5%8C%E5%85%A5/" class="">PostgresML 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/%E5%8D%83%E5%B8%86%E5%B5%8C%E5%85%A5/" class="">千帆嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6ef09998ce281d0b28a33f495c099c64" class="toggle"  />
    <label for="section-6ef09998ce281d0b28a33f495c099c64" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/google-vertexai/" class="">Google VertexAI</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/google-vertexai/google-vertexai-%E6%96%87%E6%9C%AC%E5%B5%8C%E5%85%A5/" class="">Google VertexAI 文本嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/google-vertexai/google-vertexai-%E5%A4%9A%E6%A8%A1%E6%80%81%E5%B5%8C%E5%85%A5/" class="">Google VertexAI 多模态嵌入</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%B5%8C%E5%85%A5%E6%A8%A1%E5%9E%8B-api/zhipuai-%E5%B5%8C%E5%85%A5/" class="">ZhiPuAI 嵌入</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-76b7909527d5ee378c9b7db9a7915572" class="toggle"  />
    <label for="section-76b7909527d5ee378c9b7db9a7915572" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%9B%BE%E5%83%8F%E6%A8%A1%E5%9E%8B-api/" class="">图像模型 API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%9B%BE%E5%83%8F%E6%A8%A1%E5%9E%8B-api/azure-openai-%E5%9B%BE%E5%83%8F%E7%94%9F%E6%88%90/" class="">Azure OpenAI 图像生成</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%9B%BE%E5%83%8F%E6%A8%A1%E5%9E%8B-api/openai-%E5%9B%BE%E5%83%8F%E7%94%9F%E6%88%90/" class="">OpenAI 图像生成</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%9B%BE%E5%83%8F%E6%A8%A1%E5%9E%8B-api/%E7%A8%B3%E5%AE%9A%E6%80%A7-ai-%E5%9B%BE%E5%83%8F%E7%94%9F%E6%88%90/" class="">稳定性 AI 图像生成</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%9B%BE%E5%83%8F%E6%A8%A1%E5%9E%8B-api/zhipuai-%E5%9B%BE%E5%83%8F%E7%94%9F%E6%88%90/" class="">ZhiPuAI 图像生成</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E5%9B%BE%E5%83%8F%E6%A8%A1%E5%9E%8B-api/%E5%8D%83%E5%B8%86%E5%BD%B1%E5%83%8F/" class="">千帆影像</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5d0e4aa0b317a2520fab3d41a9b47b16" class="toggle"  />
    <label for="section-5d0e4aa0b317a2520fab3d41a9b47b16" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E9%9F%B3%E9%A2%91%E6%A8%A1%E5%9E%8B/" class="">音频模型</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7819d6457dfee9d52c1df4ade06e9929" class="toggle"  />
    <label for="section-7819d6457dfee9d52c1df4ade06e9929" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E9%9F%B3%E9%A2%91%E6%A8%A1%E5%9E%8B/%E8%BD%AC%E5%BD%95-api/" class="">转录 API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E9%9F%B3%E9%A2%91%E6%A8%A1%E5%9E%8B/%E8%BD%AC%E5%BD%95-api/azure-openai-%E8%BD%AC%E5%BD%95/" class="">Azure OpenAI 转录</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4d35c258b8bf725a4f8fe541655ffeee" class="toggle"  />
    <label for="section-4d35c258b8bf725a4f8fe541655ffeee" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E9%9F%B3%E9%A2%91%E6%A8%A1%E5%9E%8B/%E6%96%87%E6%9C%AC%E8%BD%AC%E8%AF%AD%E9%9F%B3-tts-api/" class="">文本转语音 (TTS) API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E9%9F%B3%E9%A2%91%E6%A8%A1%E5%9E%8B/%E6%96%87%E6%9C%AC%E8%BD%AC%E8%AF%AD%E9%9F%B3-tts-api/openai-%E6%96%87%E6%9C%AC%E8%BD%AC%E8%AF%AD%E9%9F%B3-tts/" class="">OpenAI 文本转语音 (TTS)</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f10d18dff0bfc099fff60511d3eb1388" class="toggle"  />
    <label for="section-f10d18dff0bfc099fff60511d3eb1388" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E9%80%82%E5%BA%A6/" class="">适度</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B/%E9%80%82%E5%BA%A6/%E9%80%82%E5%BA%A6/" class="">适度</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BF%86/" class="">聊天记忆</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E5%B7%A5%E5%85%B7%E8%B0%83%E7%94%A8/" class="">工具调用</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-137a5cc62c39eb40ab9f360dd7a4089e" class="toggle"  />
    <label for="section-137a5cc62c39eb40ab9f360dd7a4089e" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E5%8D%8F%E8%AE%AEmcp/" class="">模型上下文协议（MCP）</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E5%8D%8F%E8%AE%AEmcp/mcp-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%90%AF%E5%8A%A8%E5%99%A8/" class="">MCP 客户端启动器</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E5%8D%8F%E8%AE%AEmcp/mcp-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8%E5%99%A8/" class="">MCP 服务器启动器</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A8%A1%E5%9E%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E5%8D%8F%E8%AE%AEmcp/mcp-%E5%AE%9E%E7%94%A8%E7%A8%8B%E5%BA%8F/" class="">MCP 实用程序</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-fe0a04b7ec0575e520d9c454f1ab8388" class="toggle"  />
    <label for="section-fe0a04b7ec0575e520d9c454f1ab8388" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A3%80%E7%B4%A2%E5%A2%9E%E5%BC%BA%E7%94%9F%E6%88%90/" class="">检索增强生成</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%A3%80%E7%B4%A2%E5%A2%9E%E5%BC%BA%E7%94%9F%E6%88%90/etl-%E7%AE%A1%E9%81%93/" class="">ETL 管道</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E8%AF%84%E4%BC%B0%E6%B5%8B%E8%AF%95/" class="">评估测试</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c22b15d029e06bc3f36d75f90efdc60f" class="toggle"  />
    <label for="section-c22b15d029e06bc3f36d75f90efdc60f" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" class="">矢量数据库</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/azure-ai-%E6%9C%8D%E5%8A%A1/" class="">Azure AI 服务</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/azure-cosmos-db/" class="">Azure Cosmos DB</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/apache-cassandra-%E7%9F%A2%E9%87%8F%E5%AD%98%E5%82%A8/" class="">Apache Cassandra 矢量存储</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/%E8%89%B2%E5%BA%A6/" class="">色度</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/couchbase/" class="">Couchbase</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/elasticsearch/" class="">Elasticsearch</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/gemfire-%E7%9F%A2%E9%87%8F%E5%95%86%E5%BA%97/" class="">GemFire 矢量商店</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/mariadb-%E5%90%91%E9%87%8F%E5%AD%98%E5%82%A8/" class="">MariaDB 向量存储</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/milvus/" class="">Milvus</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/mongodb-atlas/" class="">MongoDB Atlas</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/neo4j/" class="">Neo4j</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%BC%80%E6%94%BE%E6%90%9C%E7%B4%A2/" class="">开放搜索</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/oracle-database-23ai---ai-%E5%90%91%E9%87%8F%E6%90%9C%E7%B4%A2/" class="">Oracle Database 23ai - AI 向量搜索</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/pg-%E8%BD%BD%E4%BD%93/" class="">PG 载体</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%9D%BE%E6%9E%9C/" class="">松果</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%8D%A1%E5%BE%B7%E5%85%B0%E7%89%B9/" class="">卡德兰特</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/redis/" class="">Redis</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/sap-hana-%E4%BA%91/" class="">SAP HANA 云</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/typesense/" class="">Typesense</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%A8%81%E7%BB%B4%E7%89%B9/" class="">威维特</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E5%8F%AF%E8%A7%82%E5%AF%9F%E6%80%A7/" class="">可观察性</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E5%BC%80%E5%8F%91%E6%97%B6%E6%9C%8D%E5%8A%A1/" class="">开发时服务</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-13f6ed8395cc1d209c839158e47f69af" class="toggle"  />
    <label for="section-13f6ed8395cc1d209c839158e47f69af" class="flex justify-between">
      <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%B5%8B%E8%AF%95/" class="">测试</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8F%82%E8%80%83/%E6%B5%8B%E8%AF%95/%E6%B5%8B%E8%AF%95%E5%AE%B9%E5%99%A8/" class="">测试容器</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-eb04feb0bc33d1a0586638a4be3d86d6" class="toggle" checked />
    <label for="section-eb04feb0bc33d1a0586638a4be3d86d6" class="flex justify-between">
      <a href="../../../docs/%E6%8C%87%E5%8D%97/" class="">指南</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E6%8C%87%E5%8D%97/%E6%8F%90%E7%A4%BA%E5%B7%A5%E7%A8%8B%E6%A8%A1%E5%BC%8F/" class="active">提示工程模式</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E6%8C%87%E5%8D%97/%E6%9E%84%E5%BB%BA%E6%9C%89%E6%95%88%E4%BB%A3%E7%90%86/" class="">构建有效代理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E6%8C%87%E5%8D%97/%E4%BA%91%E7%BB%91%E5%AE%9A/" class="">云绑定</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-21dbdbec9c50b4c816faee9156087e37" class="toggle"  />
    <label for="section-21dbdbec9c50b4c816faee9156087e37" class="flex justify-between">
      <a href="../../../docs/%E5%8D%87%E7%BA%A7%E8%AF%B4%E6%98%8E/" class="">升级说明</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../docs/%E5%8D%87%E7%BA%A7%E8%AF%B4%E6%98%8E/%E4%BB%8E-functioncallback-%E8%BF%81%E7%A7%BB%E5%88%B0-toolcallback-api/" class="">从 FunctionCallback 迁移到 ToolCallback API</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>










  
<ul>
  
  <li>
    <a href="https://github.com"  target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="../../../svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>提示工程模式</h3>

  <label for="toc-control">
    
    <img src="../../../svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#提示工程模式">提示工程模式</a>
      <ul>
        <li><a href="#1配置">1.配置</a></li>
        <li><a href="#法学硕士llm提供商选择">法学硕士（LLM）提供商选择</a></li>
        <li><a href="#llm-输出配置">LLM 输出配置</a></li>
        <li><a href="#温度">温度</a></li>
        <li><a href="#输出长度maxtokens">输出长度（MaxTokens）</a></li>
        <li><a href="#采样控制top-k-和-top-p">采样控制（Top-K 和 Top-P）</a></li>
        <li><a href="#结构化响应格式">结构化响应格式</a></li>
        <li><a href="#特定于模型的选项">特定于模型的选项</a></li>
        <li><a href="#2-快捷的工程技术">2. 快捷的工程技术</a></li>
        <li><a href="#21-零次提示">2.1 零次提示</a></li>
        <li><a href="#22-一次性提示和少量提示">2.2 一次性提示和少量提示</a></li>
        <li><a href="#23-系统情境和角色提示">2.3 系统、情境和角色提示</a></li>
        <li><a href="#系统提示">系统提示</a></li>
        <li><a href="#角色提示">角色提示</a></li>
        <li><a href="#情境提示">情境提示</a></li>
        <li><a href="#24-后退提示">2.4 后退提示</a></li>
        <li><a href="#25-思路链cot">2.5 思路链（CoT）</a></li>
        <li><a href="#26-自洽性">2.6 自洽性</a></li>
        <li><a href="#27-思想之树tot">2.7 思想之树（ToT）</a></li>
        <li><a href="#28-自动提示工程">2.8 自动提示工程</a></li>
        <li><a href="#29-代码提示">2.9 代码提示</a></li>
        <li><a href="#结论">结论</a></li>
        <li><a href="#参考">参考</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="提示工程模式">
  提示工程模式
  <a class="anchor" href="#%e6%8f%90%e7%a4%ba%e5%b7%a5%e7%a8%8b%e6%a8%a1%e5%bc%8f">#</a>
</h1>
<p>基于全面的[
  <a href="https://www.kaggle.com/whitepaper-prompt-engineering">即时工程指南</a>](
  <a href="https://www.kaggle.com/whitepaper-prompt-engineering">https://www.kaggle.com/whitepaper-prompt-engineering</a>) ，我们将对即时工程技术进行实际应用。该指南涵盖了有效即时工程的理论、原则和模式，并演示了如何使用 Spring AI 流畅的 [
  <a href="../chatclient.html">ChatClient API</a>](../chatclient.html) 将这些概念转化为可运行的 Java 代码。本文中使用的演示源代码可在以下位置获取： [
  <a href="https://github.com/spring-projects/spring-ai-examples/tree/main/prompt-engineering/prompt-engineering-patterns">即时工程模式示例</a>](
  <a href="https://github.com/spring-projects/spring-ai-examples/tree/main/prompt-engineering/prompt-engineering-patterns">https://github.com/spring-projects/spring-ai-examples/tree/main/prompt-engineering/prompt-engineering-patterns</a>) 。</p>
<h2 id="1配置">
  1.配置
  <a class="anchor" href="#1%e9%85%8d%e7%bd%ae">#</a>
</h2>
<p>配置部分概述了如何使用 Spring AI 设置和调整大型语言模型 (LLM)。它涵盖了如何根据用例选择合适的 LLM 提供程序，以及如何配置重要的生成参数，以控制模型输出的质量、样式和格式。</p>
<h2 id="法学硕士llm提供商选择">
  法学硕士（LLM）提供商选择
  <a class="anchor" href="#%e6%b3%95%e5%ad%a6%e7%a1%95%e5%a3%abllm%e6%8f%90%e4%be%9b%e5%95%86%e9%80%89%e6%8b%a9">#</a>
</h2>
<p>为了快速进行工程设计，您需要先选择一个模型。Spring AI 支持[
  <a href="comparison.html">多个 LLM 提供商</a>](comparison.html) （例如 OpenAI、Anthropic、Google Vertex AI、AWS Bedrock、Ollama 等），让您无需更改应用程序代码即可切换提供商 - 只需更新配置即可。只需添加所选的启动依赖项 <code>spring-ai-starter-model-&lt;MODEL-PROVIDER-NAME&gt;</code> 即可。例如，以下是如何启用 Anthropic Claude API：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.ai<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>spring-ai-starter-model-anthropic<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>您可以像这样指定 LLM 模型名称：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>.<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#34;claude-3-7-sonnet-latest&#34;</span>)  <span style="color:#75715e">// Use Anthropic&#39;s Claude model</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">build</span>())
</span></span></code></pre></div><p>在[
  <a href="../chatmodel.html">参考文档</a>](../chatmodel.html)中查找有关启用每个模型的详细信息。</p>
<h2 id="llm-输出配置">
  LLM 输出配置
  <a class="anchor" href="#llm-%e8%be%93%e5%87%ba%e9%85%8d%e7%bd%ae">#</a>
</h2>
<p>
  <img src="../../../images/chat-options-flow.jpg" alt="" /></p>
<p>在深入研究即时工程技术之前，我们有必要了解如何配置 LLM 的输出行为。Spring AI 提供了多个配置选项，可让您通过 [
  <a href="../chatmodel.html#_chat_options">ChatOptions</a>](../chatmodel.html#_chat_options) 构建器控制生成的各个方面。</p>
<p>所有配置都可以以编程方式应用，如下面的示例所示，或者在启动时通过 Spring 应用程序属性应用。</p>
<h2 id="温度">
  温度
  <a class="anchor" href="#%e6%b8%a9%e5%ba%a6">#</a>
</h2>
<p>温度控制模型响应的随机性或“创造性”。</p>
<ul>
<li>较低值（0.0-0.3） ：响应更确定、更集中。更适合事实类问题、分类问题或一致性至关重要的任务。</li>
<li>中等值（0.4-0.7） ：在确定性和创造性之间取得平衡。适用于一般用例。</li>
<li>值越高 (0.8-1.0) ：回复更具创意、多样性，且可能带来惊喜。更适合创意写作、头脑风暴或生成多样化选项。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>.<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">temperature</span>(0.<span style="color:#a6e22e">1</span>)  <span style="color:#75715e">// Very deterministic output</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">build</span>())
</span></span></code></pre></div><p>了解温度对于快速工程至关重要，因为不同的技术受益于不同的温度设置。</p>
<h2 id="输出长度maxtokens">
  输出长度（MaxTokens）
  <a class="anchor" href="#%e8%be%93%e5%87%ba%e9%95%bf%e5%ba%a6maxtokens">#</a>
</h2>
<p><code>maxTokens</code> 参数限制了模型在响应中可以生成的标记（词片段）的数量。</p>
<ul>
<li>低值（5-25） ：适用于单个单词、短语或分类标签。</li>
<li>中等值（50-500） ：用于段落或简短解释。</li>
<li>高值（1000+） ：适用于长篇内容、故事或复杂的解释。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>.<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">maxTokens</span>(250)  <span style="color:#75715e">// Medium-length response</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">build</span>())
</span></span></code></pre></div><p>设置适当的输出长度非常重要，以确保您获得完整的响应而没有不必要的冗长。</p>
<h2 id="采样控制top-k-和-top-p">
  采样控制（Top-K 和 Top-P）
  <a class="anchor" href="#%e9%87%87%e6%a0%b7%e6%8e%a7%e5%88%b6top-k-%e5%92%8c-top-p">#</a>
</h2>
<p>这些参数使您可以对生成过程中的令牌选择过程进行细粒度的控制。</p>
<ul>
<li>Top-K ：将 token 的选择范围限制为 K 个最有可能的后续 token。值越高（例如 40-50），多样性越好。</li>
<li>Top-P（核采样） ：从最小的标记集中动态选择，其累积概率超过 P。0.8-0.95 之类的值很常见。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>.<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">topK</span>(40)      <span style="color:#75715e">// Consider only the top 40 tokens</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">topP</span>(0.<span style="color:#a6e22e">8</span>)     <span style="color:#75715e">// Sample from tokens that cover 80% of probability mass</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">build</span>())
</span></span></code></pre></div><p>这些采样控制与温度协同作用来形成响应特性。</p>
<h2 id="结构化响应格式">
  结构化响应格式
  <a class="anchor" href="#%e7%bb%93%e6%9e%84%e5%8c%96%e5%93%8d%e5%ba%94%e6%a0%bc%e5%bc%8f">#</a>
</h2>
<p>除了纯文本响应（使用 <code>.content()</code> ）之外，Spring AI 还可以轻松地使用 <code>.entity()</code> 方法将 LLM 响应直接映射到 Java 对象。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> Sentiment {
</span></span><span style="display:flex;"><span>    POSITIVE, NEUTRAL, NEGATIVE
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Sentiment result <span style="color:#f92672">=</span> chatClient.<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;...&#34;</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">entity</span>(Sentiment.<span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p>当与指示模型返回结构化数据的系统提示相结合时，此功能特别强大。</p>
<h2 id="特定于模型的选项">
  特定于模型的选项
  <a class="anchor" href="#%e7%89%b9%e5%ae%9a%e4%ba%8e%e6%a8%a1%e5%9e%8b%e7%9a%84%e9%80%89%e9%a1%b9">#</a>
</h2>
<p>可移植的 <code>ChatOptions</code> 不仅为不同的 LLM 提供程序提供了一致的接口，Spring AI 还提供了特定于模型的选项类，用于公开特定于提供程序的功能和配置。这些特定于模型的选项允许您利用每个 LLM 提供程序的独特功能。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Using OpenAI-specific options</span>
</span></span><span style="display:flex;"><span>OpenAiChatOptions openAiOptions <span style="color:#f92672">=</span> OpenAiChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#34;gpt-4o&#34;</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">temperature</span>(0.<span style="color:#a6e22e">2</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">frequencyPenalty</span>(0.<span style="color:#a6e22e">5</span>)      <span style="color:#75715e">// OpenAI-specific parameter</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">presencePenalty</span>(0.<span style="color:#a6e22e">3</span>)       <span style="color:#75715e">// OpenAI-specific parameter</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">responseFormat</span>(<span style="color:#66d9ef">new</span> ResponseFormat(<span style="color:#e6db74">&#34;json_object&#34;</span>))  <span style="color:#75715e">// OpenAI-specific JSON mode</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">seed</span>(42)                   <span style="color:#75715e">// OpenAI-specific deterministic generation</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>String result <span style="color:#f92672">=</span> chatClient.<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;...&#34;</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">options</span>(openAiOptions)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Using Anthropic-specific options</span>
</span></span><span style="display:flex;"><span>AnthropicChatOptions anthropicOptions <span style="color:#f92672">=</span> AnthropicChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#34;claude-3-7-sonnet-latest&#34;</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">temperature</span>(0.<span style="color:#a6e22e">2</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">topK</span>(40)                   <span style="color:#75715e">// Anthropic-specific parameter</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">thinking</span>(AnthropicApi.<span style="color:#a6e22e">ThinkingType</span>.<span style="color:#a6e22e">ENABLED</span>, 1000)  <span style="color:#75715e">// Anthropic-specific thinking configuration</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>String result <span style="color:#f92672">=</span> chatClient.<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;...&#34;</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">options</span>(anthropicOptions)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">content</span>();
</span></span></code></pre></div><p>每个模型提供商都有其自己的聊天选项实现（例如 <code>OpenAiChatOptions</code> 、 <code>AnthropicChatOptions</code> 、 <code>MistralAiChatOptions</code> ），这些实现在公开提供商特定参数的同时，仍实现通用接口。这种方法让您可以灵活地使用可移植选项来实现跨提供商兼容性，或者在需要访问特定提供商的独特功能时使用模型特定的选项。</p>
<p>请注意，使用特定于模型的选项时，您的代码将与该特定提供程序绑定，从而降低可移植性。您需要在访问特定于提供程序的高级功能与在应用程序中保持提供程序独立性之间进行权衡。</p>
<h2 id="2-快捷的工程技术">
  2. 快捷的工程技术
  <a class="anchor" href="#2-%e5%bf%ab%e6%8d%b7%e7%9a%84%e5%b7%a5%e7%a8%8b%e6%8a%80%e6%9c%af">#</a>
</h2>
<p>以下每个部分都实现了指南中一项特定的快速工程技术。通过学习“快速工程”指南和这些实现，您不仅可以深入了解可用的快速工程技术，还能了解如何在生产 Java 应用程序中有效地实现它们。</p>
<h2 id="21-零次提示">
  2.1 零次提示
  <a class="anchor" href="#21-%e9%9b%b6%e6%ac%a1%e6%8f%90%e7%a4%ba">#</a>
</h2>
<p>零样本提示是指要求人工智能在不提供任何示例的情况下执行任务。这种方法测试模型从零开始理解和执行指令的能力。大型语言模型在海量文本语料库上进行训练，使其能够在没有明确演示的情况下理解“翻译”、“摘要”或“分类”等任务的含义。</p>
<p>零样本训练非常适合一些简单的任务，因为模型在训练过程中很可能已经见过类似的样本，而且您希望尽量缩短提示长度。然而，其性能可能会因任务复杂度和指令的制定方式而有所不同。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.1: General prompting / zero shot (page 15)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_zero_shot</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">enum</span> Sentiment {
</span></span><span style="display:flex;"><span>        POSITIVE, NEUTRAL, NEGATIVE
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Sentiment reviewSentiment <span style="color:#f92672">=</span> chatClient.<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Classify movie reviews as POSITIVE, NEUTRAL or NEGATIVE.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Review: &#34;Her&#34; is a disturbing study revealing the direction
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            humanity is headed if AI is allowed to keep evolving,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            unchecked. I wish there were more movies like this masterpiece.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Sentiment:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#34;claude-3-7-sonnet-latest&#34;</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">temperature</span>(0.<span style="color:#a6e22e">1</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">maxTokens</span>(5)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">build</span>())
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">entity</span>(Sentiment.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Output: &#34;</span> <span style="color:#f92672">+</span> reviewSentiment);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>此示例展示了如何在不提供示例的情况下对电影评论情绪进行分类。请注意，为了获得更确定的结果，我们采用了较低的温度 (0.1)，并且将 <code>.entity(Sentiment.class)</code> 直接映射到 Java 枚举。</p>
<p>参考文献： Brown, TB 等人 (2020)。“语言模型是少样本学习器。”arXiv:2005.14165。https [
  <a href="https://arxiv.org/abs/2005.14165">://arxiv.org/abs/2005.14165</a>](https
  <a href="https://arxiv.org/abs/2005.14165">://arxiv.org/abs/2005.14165</a>)</p>
<h2 id="22-一次性提示和少量提示">
  2.2 一次性提示和少量提示
  <a class="anchor" href="#22-%e4%b8%80%e6%ac%a1%e6%80%a7%e6%8f%90%e7%a4%ba%e5%92%8c%e5%b0%91%e9%87%8f%e6%8f%90%e7%a4%ba">#</a>
</h2>
<p>少样本提示为模型提供了一个或多个示例，以帮助指导其响应，这对于需要特定输出格式的任务特别有用。通过向模型展示所需输入-输出对的示例，它可以学习该模式并将其应用于新的输入，而无需显式更新参数。</p>
<p>单样本训练仅提供单个样本，当样本成本高昂或模式相对简单时非常有用。少样本训练则使用多个样本（通常为 3-5 个），以帮助模型更好地理解更复杂任务中的模式，或展示正确输出的不同变体。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.2: One-shot &amp; few-shot (page 16)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_one_shot_few_shots</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String pizzaOrder <span style="color:#f92672">=</span> chatClient.<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Parse a customer&#39;s pizza order into valid JSON
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            EXAMPLE 1:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            I want a small pizza with cheese, tomato sauce, and pepperoni.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            JSON Response:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ```
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;size&#34;: &#34;small&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;type&#34;: &#34;normal&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;ingredients&#34;: [&#34;cheese&#34;, &#34;tomato sauce&#34;, &#34;pepperoni&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ```
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            EXAMPLE 2:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Can I get a large pizza with tomato sauce, basil and mozzarella.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            JSON Response:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ```
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;size&#34;: &#34;large&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;type&#34;: &#34;normal&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;ingredients&#34;: [&#34;tomato sauce&#34;, &#34;basil&#34;, &#34;mozzarella&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ```
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Now, I would like a large pizza, with the first half cheese and mozzarella.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            And the other tomato sauce, ham and pineapple.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#34;claude-3-7-sonnet-latest&#34;</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">temperature</span>(0.<span style="color:#a6e22e">1</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">maxTokens</span>(250)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">build</span>())
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>对于需要特定格式、处理边缘情况，或在没有示例的情况下任务定义可能含糊不清的任务，小样本提示尤其有效。示例的质量和多样性会显著影响性能。</p>
<p>参考文献： Brown, TB 等人 (2020)。“语言模型是少样本学习器。”arXiv:2005.14165。https [
  <a href="https://arxiv.org/abs/2005.14165">://arxiv.org/abs/2005.14165</a>](https
  <a href="https://arxiv.org/abs/2005.14165">://arxiv.org/abs/2005.14165</a>)</p>
<h2 id="23-系统情境和角色提示">
  2.3 系统、情境和角色提示
  <a class="anchor" href="#23-%e7%b3%bb%e7%bb%9f%e6%83%85%e5%a2%83%e5%92%8c%e8%a7%92%e8%89%b2%e6%8f%90%e7%a4%ba">#</a>
</h2>
<h2 id="系统提示">
  系统提示
  <a class="anchor" href="#%e7%b3%bb%e7%bb%9f%e6%8f%90%e7%a4%ba">#</a>
</h2>
<p>系统提示设定了语言模型的整体背景和目的，定义了模型应该做什么的“总体情况”。它为模型的响应建立了行为框架、约束条件和高级目标，并与具体的用户查询区分开来。</p>
<p>系统提示在整个对话过程中充当着持续的“使命宣言”，允许您设置全局参数，例如输出格式、语气、道德界限或角色定义。与专注于特定任务的用户提示不同，系统提示框定了所有用户提示的解读方式。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.3.1: System prompting</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_system_prompting_1</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String movieReview <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;Classify movie reviews as positive, neutral or negative. Only return the label in uppercase.&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">user</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Review: &#34;Her&#34; is a disturbing study revealing the direction
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    humanity is headed if AI is allowed to keep evolving,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    unchecked. It&#39;s so disturbing I couldn&#39;t watch it.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Sentiment:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#34;claude-3-7-sonnet-latest&#34;</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">temperature</span>(1.<span style="color:#a6e22e">0</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">topK</span>(40)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">topP</span>(0.<span style="color:#a6e22e">8</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">maxTokens</span>(5)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">build</span>())
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>系统提示与 Spring AI 的实体映射功能结合使用时尤其强大：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.3.1: System prompting with JSON output</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">record</span> <span style="color:#a6e22e">MovieReviews</span>(Movie<span style="color:#f92672">[]</span> movie_reviews) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">enum</span> Sentiment {
</span></span><span style="display:flex;"><span>        POSITIVE, NEUTRAL, NEGATIVE
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Movie</span>(Sentiment sentiment, String name) {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MovieReviews movieReviews <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                Classify movie reviews as positive, neutral or negative. Return
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                valid JSON.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">user</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                Review: &#34;Her&#34; is a disturbing study revealing the direction
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                humanity is headed if AI is allowed to keep evolving,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                unchecked. It&#39;s so disturbing I couldn&#39;t watch it.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                JSON Response:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">entity</span>(MovieReviews.<span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p>系统提示对于多轮对话尤其有价值，可确保跨多个查询的一致行为，并建立适用于所有响应的格式约束（如 JSON 输出）。</p>
<p>参考文献： OpenAI。(2022)。“系统消息”。https [
  <a href="https://platform.openai.com/docs/guides/chat/introduction">://platform.openai.com/docs/guides/chat/introduction</a>](https
  <a href="https://platform.openai.com/docs/guides/chat/introduction">://platform.openai.com/docs/guides/chat/introduction</a>)</p>
<h2 id="角色提示">
  角色提示
  <a class="anchor" href="#%e8%a7%92%e8%89%b2%e6%8f%90%e7%a4%ba">#</a>
</h2>
<p>角色提示会指示模型采用特定的角色或人物，这会影响其生成内容的方式。通过为模型分配特定的身份、专业知识或视角，您可以影响其响应的风格、语气、深度和框架。</p>
<p>角色提示利用模型模拟不同专业领域和沟通风格的能力。常见角色包括专家（例如，“您是一位经验丰富的数据科学家”）、专业人士（例如，“充当导游”）或风格人物（例如，“像莎士比亚一样解释”）。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.3.2: Role prompting</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_role_prompting_1</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String travelSuggestions <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    I want you to act as a travel guide. I will write to you
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    about my location and you will suggest 3 places to visit near
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    me. In some cases, I will also give you the type of places I
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    will visit.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">user</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    My suggestion: &#34;I am in Amsterdam and I want to visit only museums.&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Travel Suggestions:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>可以通过样式说明来增强角色提示：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.3.2: Role prompting with style instructions</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_role_prompting_2</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String humorousTravelSuggestions <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    I want you to act as a travel guide. I will write to you about
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    my location and you will suggest 3 places to visit near me in
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    a humorous style.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">user</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    My suggestion: &#34;I am in Amsterdam and I want to visit only museums.&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Travel Suggestions:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>这种技术对于专业领域知识特别有效，可以在响应中实现一致的语气，并与用户创建更具吸引力、个性化的互动。</p>
<p>参考文献： Shanahan, M. 等人 (2023)。“使用大型语言模型进行角色扮演。”arXiv:2305.16367。https [
  <a href="https://arxiv.org/abs/2305.16367">://arxiv.org/abs/2305.16367</a>](https
  <a href="https://arxiv.org/abs/2305.16367">://arxiv.org/abs/2305.16367</a>)</p>
<h2 id="情境提示">
  情境提示
  <a class="anchor" href="#%e6%83%85%e5%a2%83%e6%8f%90%e7%a4%ba">#</a>
</h2>
<p>情境提示通过传递情境参数为模型提供额外的背景信息。这项技术丰富了模型对具体情境的理解，使其能够提供更相关、更有针对性的响应，而不会扰乱主要指令。</p>
<p>通过提供上下文信息，您可以帮助模型理解与当前查询相关的特定领域、受众、约束或背景事实。这可以带来更准确、更相关、更恰当的响应。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.3.3: Contextual prompting</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_contextual_prompting</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String articleSuggestions <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">user</span>(u <span style="color:#f92672">-&gt;</span> u.<span style="color:#a6e22e">text</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Suggest 3 topics to write an article about with a few lines of
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    description of what this article should contain.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Context: {context}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">param</span>(<span style="color:#e6db74">&#34;context&#34;</span>, <span style="color:#e6db74">&#34;You are writing for a blog about retro 80&#39;s arcade video games.&#34;</span>))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Spring AI 使用 param() 方法注入上下文变量，使上下文提示更加清晰。当模型需要特定领域知识、根据特定受众或场景调整响应，以及确保响应符合特定约束或要求时，此技术尤为有用。</p>
<p>参考文献： Liu, P. 等 (2021)。“什么是 GPT-3 的良好上下文示例？”arXiv:2101.06804。https [
  <a href="https://arxiv.org/abs/2101.06804">://arxiv.org/abs/2101.06804</a>](https
  <a href="https://arxiv.org/abs/2101.06804">://arxiv.org/abs/2101.06804</a>)</p>
<h2 id="24-后退提示">
  2.4 后退提示
  <a class="anchor" href="#24-%e5%90%8e%e9%80%80%e6%8f%90%e7%a4%ba">#</a>
</h2>
<p>后退提示法通过先获取背景知识，将复杂的请求分解成更简单的步骤。这种技术鼓励模型先从当前问题“后退一步”，思考更广泛的背景、基本原理或与问题相关的常识，然后再处理具体的问题。</p>
<p>通过将复杂问题分解为更易于管理的部分并首先建立基础知识，该模型可以对难题提供更准确的答案。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.4: Step-back prompting</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_step_back_prompting</span>(ChatClient.<span style="color:#a6e22e">Builder</span> chatClientBuilder) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Set common options for the chat client</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> chatClient <span style="color:#f92672">=</span> chatClientBuilder
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">defaultOptions</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#34;claude-3-7-sonnet-latest&#34;</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">temperature</span>(1.<span style="color:#a6e22e">0</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">topK</span>(40)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">topP</span>(0.<span style="color:#a6e22e">8</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">maxTokens</span>(1024)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">build</span>())
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// First get high-level concepts</span>
</span></span><span style="display:flex;"><span>    String stepBack <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Based on popular first-person shooter action games, what are
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    5 fictional key settings that contribute to a challenging and
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    engaging level storyline in a first-person shooter video game?
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Then use those concepts in the main task</span>
</span></span><span style="display:flex;"><span>    String story <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">user</span>(u <span style="color:#f92672">-&gt;</span> u.<span style="color:#a6e22e">text</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Write a one paragraph storyline for a new level of a first-
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    person shooter video game that is challenging and engaging.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Context: {step-back}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">param</span>(<span style="color:#e6db74">&#34;step-back&#34;</span>, stepBack))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>退后提示对于复杂的推理任务、需要专业领域知识的问题以及当您想要更全面、更周到的回应而不是立即得到答案时特别有效。</p>
<p>参考文献： Zheng, Z. 等 (2023)。“退一步思考：在大型语言模型中通过抽象引发推理。”arXiv:2310.06117。https [
  <a href="https://arxiv.org/abs/2310.06117">://arxiv.org/abs/2310.06117</a>](https
  <a href="https://arxiv.org/abs/2310.06117">://arxiv.org/abs/2310.06117</a>)</p>
<h2 id="25-思路链cot">
  2.5 思路链（CoT）
  <a class="anchor" href="#25-%e6%80%9d%e8%b7%af%e9%93%becot">#</a>
</h2>
<p>思路链提示鼓励模型逐步推理问题，从而提高复杂推理任务的准确性。通过明确要求模型展示其工作成果或以逻辑步骤思考问题，您可以显著提高需要多步骤推理的任务的性能。</p>
<p>CoT 的工作原理是鼓励模型在得出最终答案之前生成中间推理步骤，类似于人类解决复杂问题的方式。这使得模型的思维过程更加清晰，并有助于其得出更准确的结论。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.5: Chain of Thought (CoT) - Zero-shot approach</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_chain_of_thought_zero_shot</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String output <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    When I was 3 years old, my partner was 3 times my age. Now,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    I am 20 years old. How old is my partner?
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Let&#39;s think step by step.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.5: Chain of Thought (CoT) - Few-shot approach</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_chain_of_thought_singleshot_fewshots</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String output <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Q: When my brother was 2 years old, I was double his age. Now
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    I am 40 years old. How old is my brother? Let&#39;s think step
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    by step.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    A: When my brother was 2 years, I was 2 * 2 = 4 years old.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    That&#39;s an age difference of 2 years and I am older. Now I am 40
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    years old, so my brother is 40 - 2 = 38 years old. The answer
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    is 38.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Q: When I was 3 years old, my partner was 3 times my age. Now,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    I am 20 years old. How old is my partner? Let&#39;s think step
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    by step.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    A:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>关键词“让我们一步一步思考”会触发模型展示其推理过程。CoT 对于数学问题、逻辑推理任务以及任何需要多步推理的问题尤其有用。它通过明确中间推理来帮助减少错误。</p>
<p>参考文献： Wei, J. 等人 (2022)。“思维链提示在大型语言模型中引发推理。”arXiv:2201.11903。https [
  <a href="https://arxiv.org/abs/2201.11903">://arxiv.org/abs/2201.11903</a>](https
  <a href="https://arxiv.org/abs/2201.11903">://arxiv.org/abs/2201.11903</a>)</p>
<h2 id="26-自洽性">
  2.6 自洽性
  <a class="anchor" href="#26-%e8%87%aa%e6%b4%bd%e6%80%a7">#</a>
</h2>
<p>自洽性是指多次运行模型并汇总结果以获得更可靠的答案。该技术通过对同一问题进行不同的推理路径采样，并通过多数表决选出最一致的答案，解决了 LLM 输出结果的差异性问题。</p>
<p>通过生成具有不同温度或采样设置的多条推理路径，然后聚合最终答案，自洽性可以提高复杂推理任务的准确性。它本质上是一种针对 LLM 输出的集成方法。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.6: Self-consistency</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_self_consistency</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String email <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Hi,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            I have seen you use Wordpress for your website. A great open
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            source content management system. I have used it in the past
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            too. It comes with lots of great user plugins. And it&#39;s pretty
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            easy to set up.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            I did notice a bug in the contact form, which happens when
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            you select the name field. See the attached screenshot of me
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            entering text in the name field. Notice the JavaScript alert
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            box that I inv0k3d.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            But for the rest it&#39;s a great website. I enjoy reading it. Feel
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            free to leave the bug in the website, because it gives me more
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            interesting things to read.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Cheers,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Harry the Hacker.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">EmailClassification</span>(Classification classification, String reasoning) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">enum</span> Classification {
</span></span><span style="display:flex;"><span>            IMPORTANT, NOT_IMPORTANT
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> importantCount <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> notImportantCount <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Run the model 5 times with the same input</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> 5; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        EmailClassification output <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">user</span>(u <span style="color:#f92672">-&gt;</span> u.<span style="color:#a6e22e">text</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        Email: {email}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        Classify the above email as IMPORTANT or NOT IMPORTANT. Let&#39;s
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        think step by step and explain why.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>                        .<span style="color:#a6e22e">param</span>(<span style="color:#e6db74">&#34;email&#34;</span>, email))
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>                        .<span style="color:#a6e22e">temperature</span>(1.<span style="color:#a6e22e">0</span>)  <span style="color:#75715e">// Higher temperature for more variation</span>
</span></span><span style="display:flex;"><span>                        .<span style="color:#a6e22e">build</span>())
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">entity</span>(EmailClassification.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Count results</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (output.<span style="color:#a6e22e">classification</span>() <span style="color:#f92672">==</span> EmailClassification.<span style="color:#a6e22e">Classification</span>.<span style="color:#a6e22e">IMPORTANT</span>) {
</span></span><span style="display:flex;"><span>            importantCount<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            notImportantCount<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Determine the final classification by majority vote</span>
</span></span><span style="display:flex;"><span>    String finalClassification <span style="color:#f92672">=</span> importantCount <span style="color:#f92672">&gt;</span> notImportantCount <span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;IMPORTANT&#34;</span> : <span style="color:#e6db74">&#34;NOT IMPORTANT&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>对于高风险决策、复杂推理任务以及需要比单一响应更可靠答案的情况，自洽性尤为重要。但其弊端是由于多次 API 调用会增加计算成本和延迟。</p>
<p>参考文献： Wang, X. 等人 (2022)。“自一致性提升语言模型的思路链推理能力。”arXiv:2203.11171。https [
  <a href="https://arxiv.org/abs/2203.11171">://arxiv.org/abs/2203.11171</a>](https
  <a href="https://arxiv.org/abs/2203.11171">://arxiv.org/abs/2203.11171</a>)</p>
<h2 id="27-思想之树tot">
  2.7 思想之树（ToT）
  <a class="anchor" href="#27-%e6%80%9d%e6%83%b3%e4%b9%8b%e6%a0%91tot">#</a>
</h2>
<p>思路树 (ToT) 是一种高级推理框架，它通过同时探索多条推理路径来扩展思路链。它将问题解决视为一个搜索过程，模型会生成不同的中间步骤，评估其可行性，并探索最具潜力的路径。</p>
<p>这种技术对于具有多种可能方法的复杂问题或解决方案需要探索各种替代方案才能找到最佳路径的情况特别有效。</p>
<p>游戏解决 ToT 示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.7: Tree of Thoughts (ToT) - Game solving example</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_tree_of_thoughts_game</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Step 1: Generate multiple initial moves</span>
</span></span><span style="display:flex;"><span>    String initialMoves <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    You are playing a game of chess. The board is in the starting position.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Generate 3 different possible opening moves. For each move:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    1. Describe the move in algebraic notation
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    2. Explain the strategic thinking behind this move
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    3. Rate the move&#39;s strength from 1-10
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">temperature</span>(0.<span style="color:#a6e22e">7</span>)
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">build</span>())
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Step 2: Evaluate and select the most promising move</span>
</span></span><span style="display:flex;"><span>    String bestMove <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">user</span>(u <span style="color:#f92672">-&gt;</span> u.<span style="color:#a6e22e">text</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Analyze these opening moves and select the strongest one:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    {moves}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Explain your reasoning step by step, considering:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    1. Position control
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    2. Development potential
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    3. Long-term strategic advantage
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Then select the single best move.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>).<span style="color:#a6e22e">param</span>(<span style="color:#e6db74">&#34;moves&#34;</span>, initialMoves))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Step 3: Explore future game states from the best move</span>
</span></span><span style="display:flex;"><span>    String gameProjection <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">user</span>(u <span style="color:#f92672">-&gt;</span> u.<span style="color:#a6e22e">text</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Based on this selected opening move:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    {best_move}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Project the next 3 moves for both players. For each potential branch:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    1. Describe the move and counter-move
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    2. Evaluate the resulting position
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    3. Identify the most promising continuation
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Finally, determine the most advantageous sequence of moves.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>).<span style="color:#a6e22e">param</span>(<span style="color:#e6db74">&#34;best_move&#34;</span>, bestMove))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>参考文献： Yao, S. 等 (2023)。“思维树：基于大型语言模型的深思熟虑的问题求解”。arXiv:2305.10601。https [
  <a href="https://arxiv.org/abs/2305.10601">://arxiv.org/abs/2305.10601</a>](https
  <a href="https://arxiv.org/abs/2305.10601">://arxiv.org/abs/2305.10601</a>)</p>
<h2 id="28-自动提示工程">
  2.8 自动提示工程
  <a class="anchor" href="#28-%e8%87%aa%e5%8a%a8%e6%8f%90%e7%a4%ba%e5%b7%a5%e7%a8%8b">#</a>
</h2>
<p>自动提示工程利用人工智能生成并评估备选提示。这项元技术利用语言模型本身来创建、改进和基准测试不同的提示变体，以找到特定任务的最佳方案。</p>
<p>通过系统地生成和评估提示语的变化，APE 可以找到比人工设计更有效的提示语，尤其是在处理复杂任务时。这是利用 AI 提升自身性能的一种方式。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.8: Automatic Prompt Engineering</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_automatic_prompt_engineering</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Generate variants of the same request</span>
</span></span><span style="display:flex;"><span>    String orderVariants <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    We have a band merchandise t-shirt webshop, and to train a
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    chatbot we need various ways to order: &#34;One Metallica t-shirt
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    size S&#34;. Generate 10 variants, with the same semantics but keep
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    the same meaning.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">temperature</span>(1.<span style="color:#a6e22e">0</span>)  <span style="color:#75715e">// High temperature for creativity</span>
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">build</span>())
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Evaluate and select the best variant</span>
</span></span><span style="display:flex;"><span>    String output <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">user</span>(u <span style="color:#f92672">-&gt;</span> u.<span style="color:#a6e22e">text</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Please perform BLEU (Bilingual Evaluation Understudy) evaluation on the following variants:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    ----
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    {variants}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    ----
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Select the instruction candidate with the highest evaluation score.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>).<span style="color:#a6e22e">param</span>(<span style="color:#e6db74">&#34;variants&#34;</span>, orderVariants))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>APE 对于优化生产系统的提示、解决手动提示工程已达到极限的挑战性任务以及系统地大规模提高提示质量特别有价值。</p>
<p>参考文献： Zhou, Y. 等 (2022)。“大型语言模型是人类级别的快速工程师。”arXiv:2211.01910。https [
  <a href="https://arxiv.org/abs/2211.01910">://arxiv.org/abs/2211.01910</a>](https
  <a href="https://arxiv.org/abs/2211.01910">://arxiv.org/abs/2211.01910</a>)</p>
<h2 id="29-代码提示">
  2.9 代码提示
  <a class="anchor" href="#29-%e4%bb%a3%e7%a0%81%e6%8f%90%e7%a4%ba">#</a>
</h2>
<p>代码提示是指针对代码相关任务的专门技术。这些技术利用法学硕士 (LLM) 理解和生成编程语言的能力，使他们能够编写新代码、解释现有代码、调试问题以及在语言之间进行转换。</p>
<p>有效的代码提示通常包含清晰的规范、合适的上下文（库、框架、代码规范），有时还会包含类似代码的示例。为了获得更确定的输出，温度设置通常较低（0.1-0.3）。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.9.1: Prompts for writing code</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_code_prompting_writing_code</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String bashScript <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Write a code snippet in Bash, which asks for a folder name.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Then it takes the contents of the folder and renames all the
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    files inside by prepending the name draft to the file name.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">options</span>(ChatOptions.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">temperature</span>(0.<span style="color:#a6e22e">1</span>)  <span style="color:#75715e">// Low temperature for deterministic code</span>
</span></span><span style="display:flex;"><span>                    .<span style="color:#a6e22e">build</span>())
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.9.2: Prompts for explaining code</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_code_prompting_explaining_code</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String code <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            #!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            echo &#34;Enter the folder name: &#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            read folder_name
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            if [ ! -d &#34;$folder_name&#34; ]; then
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            echo &#34;Folder does not exist.&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            exit 1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            fi
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            files=( &#34;$folder_name&#34;/* )
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            for file in &#34;${files[@]}&#34;; do
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            new_file_name=&#34;draft_$(basename &#34;$file&#34;)&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            mv &#34;$file&#34; &#34;$new_file_name&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            done
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            echo &#34;Files renamed successfully.&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    String explanation <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">user</span>(u <span style="color:#f92672">-&gt;</span> u.<span style="color:#a6e22e">text</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Explain to me the below Bash code:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    ```
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    {code}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    ```
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>).<span style="color:#a6e22e">param</span>(<span style="color:#e6db74">&#34;code&#34;</span>, code))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Implementation of Section 2.9.3: Prompts for translating code</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pt_code_prompting_translating_code</span>(ChatClient chatClient) {
</span></span><span style="display:flex;"><span>    String bashCode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            #!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            echo &#34;Enter the folder name: &#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            read folder_name
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            if [ ! -d &#34;$folder_name&#34; ]; then
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            echo &#34;Folder does not exist.&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            exit 1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            fi
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            files=( &#34;$folder_name&#34;/* )
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            for file in &#34;${files[@]}&#34;; do
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            new_file_name=&#34;draft_$(basename &#34;$file&#34;)&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            mv &#34;$file&#34; &#34;$new_file_name&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            done
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            echo &#34;Files renamed successfully.&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    String pythonCode <span style="color:#f92672">=</span> chatClient
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">user</span>(u <span style="color:#f92672">-&gt;</span> u.<span style="color:#a6e22e">text</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    Translate the below Bash code to a Python snippet:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    {code}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>).<span style="color:#a6e22e">param</span>(<span style="color:#e6db74">&#34;code&#34;</span>, bashCode))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">content</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>代码提示对于自动化代码文档、原型设计、学习编程概念以及编程语言间的转换尤其有用。将其与少样本提示或思路链等技术结合使用，可以进一步提升其有效性。</p>
<p>参考文献： Chen, M. 等人 (2021)。“评估基于代码训练的大型语言模型。”arXiv:2107.03374。https [
  <a href="https://arxiv.org/abs/2107.03374">://arxiv.org/abs/2107.03374</a>](https
  <a href="https://arxiv.org/abs/2107.03374">://arxiv.org/abs/2107.03374</a>)</p>
<h2 id="结论">
  结论
  <a class="anchor" href="#%e7%bb%93%e8%ae%ba">#</a>
</h2>
<p>Spring AI 提供了优雅的 Java API，用于实现所有主要的即时工程技术。通过将这些技术与 Spring 强大的实体映射和流畅的 API 相结合，开发人员可以使用简洁、可维护的代码构建复杂的 AI 应用。</p>
<p>最有效的方法通常需要结合多种技术——例如，将系统提示与少量样本示例结合使用，或将思路链与角色提示结合使用。Spring AI 灵活的 API 使这些组合易于实现。</p>
<p>对于生产应用程序，请记住：</p>
<p>借助这些技术和 Spring AI 强大的抽象，您可以创建强大的 AI 驱动应用程序，提供一致、高质量的结果。</p>
<h2 id="参考">
  参考
  <a class="anchor" href="#%e5%8f%82%e8%80%83">#</a>
</h2>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#提示工程模式">提示工程模式</a>
      <ul>
        <li><a href="#1配置">1.配置</a></li>
        <li><a href="#法学硕士llm提供商选择">法学硕士（LLM）提供商选择</a></li>
        <li><a href="#llm-输出配置">LLM 输出配置</a></li>
        <li><a href="#温度">温度</a></li>
        <li><a href="#输出长度maxtokens">输出长度（MaxTokens）</a></li>
        <li><a href="#采样控制top-k-和-top-p">采样控制（Top-K 和 Top-P）</a></li>
        <li><a href="#结构化响应格式">结构化响应格式</a></li>
        <li><a href="#特定于模型的选项">特定于模型的选项</a></li>
        <li><a href="#2-快捷的工程技术">2. 快捷的工程技术</a></li>
        <li><a href="#21-零次提示">2.1 零次提示</a></li>
        <li><a href="#22-一次性提示和少量提示">2.2 一次性提示和少量提示</a></li>
        <li><a href="#23-系统情境和角色提示">2.3 系统、情境和角色提示</a></li>
        <li><a href="#系统提示">系统提示</a></li>
        <li><a href="#角色提示">角色提示</a></li>
        <li><a href="#情境提示">情境提示</a></li>
        <li><a href="#24-后退提示">2.4 后退提示</a></li>
        <li><a href="#25-思路链cot">2.5 思路链（CoT）</a></li>
        <li><a href="#26-自洽性">2.6 自洽性</a></li>
        <li><a href="#27-思想之树tot">2.7 思想之树（ToT）</a></li>
        <li><a href="#28-自动提示工程">2.8 自动提示工程</a></li>
        <li><a href="#29-代码提示">2.9 代码提示</a></li>
        <li><a href="#结论">结论</a></li>
        <li><a href="#参考">参考</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












