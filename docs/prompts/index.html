<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  提示
  #

提示是指导 AI 模型生成特定输出的输入。这些提示的设计和措辞会显著影响模型的响应。
在 Spring AI 中与 AI 模型交互的最低级别上，在 Spring AI 中处理提示有点类似于在 Spring MVC 中管理“视图”。这涉及使用动态内容的占位符创建大量文本。然后，根据用户请求或应用程序中的其他代码替换这些占位符。另一个类比是包含某些表达式的占位符的 SQL 语句。
随着 Spring AI 的发展，它将引入更高级别的抽象来与 AI 模型交互。本节中描述的基础类在角色和功能方面可以比作 JDBC。例如，ChatModel 类类似于 JDK 中的核心 JDBC 库。ChatClient 类可以比作 JdbcClient，它构建在 ChatModel 之上，并通过 Advisor 提供更高级的构造
要考虑过去与模型的交互，请使用额外的上下文文档来增强提示，并引入代理行为。
随着时间的推移，提示的结构在 AI 领域内不断发展。最初，提示是简单的字符串。随着时间的推移，它们逐渐包括特定输入的占位符，例如 AI 模型可以识别的“USER：”。OpenAI 通过在 AI 模型处理之前将多个消息字符串分类为不同的角色，为提示引入了更多结构。

  API 概述
  #


  提示
  #

通常使用 ChatModel 的 call（） 方法，该方法采用 Prompt 实例并返回 ChatResponse。
Prompt 类充当一系列有组织的 Message 对象和请求 ChatOptions 的容器。每条 Message 在提示中都包含一个独特的角色，其内容和意图不同。这些角色可以包含各种元素，从用户查询到 AI 生成的对相关背景信息的响应。这种安排支持与 AI 模型进行复杂而详细的交互，因为提示是由多条消息构建的，每条消息都分配了在对话中扮演的特定角色。
下面是 Prompt 类的截断版本，为简洁起见，省略了构造函数和实用程序方法：">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://studyllm.github.io/docs/prompts/">
  <meta property="og:site_name" content="Spring AI 1.0.0">
  <meta property="og:title" content="提示">
  <meta property="og:description" content="提示 # 提示是指导 AI 模型生成特定输出的输入。这些提示的设计和措辞会显著影响模型的响应。 在 Spring AI 中与 AI 模型交互的最低级别上，在 Spring AI 中处理提示有点类似于在 Spring MVC 中管理“视图”。这涉及使用动态内容的占位符创建大量文本。然后，根据用户请求或应用程序中的其他代码替换这些占位符。另一个类比是包含某些表达式的占位符的 SQL 语句。 随着 Spring AI 的发展，它将引入更高级别的抽象来与 AI 模型交互。本节中描述的基础类在角色和功能方面可以比作 JDBC。例如，ChatModel 类类似于 JDK 中的核心 JDBC 库。ChatClient 类可以比作 JdbcClient，它构建在 ChatModel 之上，并通过 Advisor 提供更高级的构造 要考虑过去与模型的交互，请使用额外的上下文文档来增强提示，并引入代理行为。 随着时间的推移，提示的结构在 AI 领域内不断发展。最初，提示是简单的字符串。随着时间的推移，它们逐渐包括特定输入的占位符，例如 AI 模型可以识别的“USER：”。OpenAI 通过在 AI 模型处理之前将多个消息字符串分类为不同的角色，为提示引入了更多结构。
API 概述 # 提示 # 通常使用 ChatModel 的 call（） 方法，该方法采用 Prompt 实例并返回 ChatResponse。 Prompt 类充当一系列有组织的 Message 对象和请求 ChatOptions 的容器。每条 Message 在提示中都包含一个独特的角色，其内容和意图不同。这些角色可以包含各种元素，从用户查询到 AI 生成的对相关背景信息的响应。这种安排支持与 AI 模型进行复杂而详细的交互，因为提示是由多条消息构建的，每条消息都分配了在对话中扮演的特定角色。 下面是 Prompt 类的截断版本，为简洁起见，省略了构造函数和实用程序方法：">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>提示 | Spring AI 1.0.0</title>
<link rel="icon" href="../../favicon.png" >
<link rel="manifest" href="../../manifest.json">
<link rel="canonical" href="https://studyllm.github.io/docs/prompts/">
<link rel="stylesheet" href="../../book.min.e9f68c3fff3d8236a489d16a9caf6de5e4d1a29c20eb4b5524e42cd30be4d319.css" integrity="sha256-6faMP/89gjakidFqnK9t5eTRopwg60tVJOQs0wvk0xk=" crossorigin="anonymous">
  <script defer src="../../fuse.min.js"></script>
  <script defer src="../../en.search.min.fc796ecb96a612ae39040eb9138814514c32a2e7d9265637e01d9c788994e3c8.js" integrity="sha256-/Hluy5amEq45BA65E4gUUUwyoufZJlY34B2ceImU48g=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="../../"><span>Spring AI 1.0.0</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e2fd78a721f271b7efc6437520b70692" class="toggle"  />
    <label for="section-e2fd78a721f271b7efc6437520b70692" class="flex justify-between">
      <a href="../../docs/overview-%E6%A6%82%E8%BF%B0/" class="">介绍</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/overview-%E6%A6%82%E8%BF%B0/ai-concepts-ai-%E6%A6%82%E5%BF%B5/" class="">AI 概念</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/getting-started-%E5%BC%80%E5%A7%8B/" class="">开始</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-46da0dacd3edcb609eb3a30122f798c1" class="toggle"  />
    <label for="section-46da0dacd3edcb609eb3a30122f798c1" class="flex justify-between">
      <a href="../../docs/upgrade-notes-%E5%8D%87%E7%BA%A7%E8%AF%B4%E6%98%8E/" class="">升级说明</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/upgrade-notes-%E5%8D%87%E7%BA%A7%E8%AF%B4%E6%98%8E/migrating-functioncallback-to-toolcallback-api/" class="">从 FunctionCallback 迁移到 ToolCallback API</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9cc275e26831a4c68f5f0626954bb051" class="toggle"  />
    <label for="section-9cc275e26831a4c68f5f0626954bb051" class="flex justify-between">
      <a href="../../docs/chat-client-api/" class="">聊天客户端 API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/chat-client-api/advisors/" class="">顾问 API</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/prompts/" class="active">提示</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/structured-output/" class="">结构化输出转换器</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/multimodality/" class="">多模态 API</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-dff98c888805ee5be8c49a91de636d7a" class="toggle"  />
    <label for="section-dff98c888805ee5be8c49a91de636d7a" class="flex justify-between">
      <a href="../../docs/models/" class="">None</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a549f27d0c7522c5a488c8e70bc18d95" class="toggle"  />
    <label for="section-a549f27d0c7522c5a488c8e70bc18d95" class="flex justify-between">
      <a href="../../docs/models/chat-models/" class="">聊天模型 API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/chat-models-comparison/" class="">聊天模型比较</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/amazon-bedrock-converse/" class="">基岩版 Converse API</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/anthropic-3/" class="">Anthropic 3 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/azure-openai/" class="">Azure OpenAI 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/deepseek/" class="">DeepSeek 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/docker-model-runner/" class="">Docker Model Runner 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-23643788106caecd71158902b516c092" class="toggle"  />
    <label for="section-23643788106caecd71158902b516c092" class="flex justify-between">
      <a href="../../docs/models/chat-models/google-vertexai/" class="">谷歌 VertexAI API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/google-vertexai/vertexai-gemini/" class="">VertexAI Gemini 聊天</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/groq/" class="">Groq 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/hugging-face/" class="">拥抱脸聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/mistral-ai/" class="">Mistral AI 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/minimax/" class="">MiniMax 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/moonshot-ai/" class="">Moonshot AI 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/nvidia/" class="">NVIDIA 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/ollama/" class="">Ollama 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/perplexity-ai/" class="">困惑聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/openai/" class="">OpenAI 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/qianfan/" class="">千帆聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/chat-models/zhipu-ai/" class="">智普 AI 聊天</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-91d39169afbe390a9cfdcf43422a5f77" class="toggle"  />
    <label for="section-91d39169afbe390a9cfdcf43422a5f77" class="flex justify-between">
      <a href="../../docs/models/audio-models/transcription-api/" class="">转录 API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/audio-models/transcription-api/azure-openai/" class="">Azure OpenAI 听录</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/moderation-models/openai/" class="">适度</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c7747c1c4ca7e7f27485d3b4a2909173" class="toggle"  />
    <label for="section-c7747c1c4ca7e7f27485d3b4a2909173" class="flex justify-between">
      <a href="../../docs/models/embedding-models/" class="">嵌入模型 API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f3b5329a5faed8a311a538c92b457f6a" class="toggle"  />
    <label for="section-f3b5329a5faed8a311a538c92b457f6a" class="flex justify-between">
      <a href="../../docs/models/embedding-models/amazon-bedrock/" class="">亚马逊基岩版</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/amazon-bedrock/cohere/" class="">Cohere 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/amazon-bedrock/titan/" class="">Titan 嵌入</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/azure-openai/" class="">Azure OpenAI 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/mistral-ai/" class="">Mistral AI 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/minimax/" class="">MiniMax 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/oci-genai/" class="">Oracle Cloud Infrastructure （OCI） GenAI 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/ollama/" class="">Ollama 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/onnx-transformers/" class="">变压器 （ONNX） 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/openai/" class="">OpenAI 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/postgresml/" class="">PostgresML 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/qianfan/" class="">QianFan 嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/embedding-models/zhipu-ai/" class="">ZhiPuAI 嵌入</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-602ef13071faddbe2271a0f29c030c5f" class="toggle"  />
    <label for="section-602ef13071faddbe2271a0f29c030c5f" class="flex justify-between">
      <a href="../../docs/models/audio-models/text-to-speech-tts-api/" class="">文本转语音 （TTS） API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/audio-models/text-to-speech-tts-api/openai/" class="">OpenAI 文本转语音 （TTS）</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/moderation-models/mistral-ai/" class="">适度</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4c392088dcec5ee943e5103c3c64745e" class="toggle"  />
    <label for="section-4c392088dcec5ee943e5103c3c64745e" class="flex justify-between">
      <a href="../../docs/models/image-models/" class="">图像模型 API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/image-models/azure-openai/" class="">Azure OpenAI 映像生成</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/image-models/openai/" class="">OpenAI 图像生成</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/image-models/stability/" class="">稳定性 AI 图像生成</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/image-models/zhipuai/" class="">智普 AI 图像生成</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/models/image-models/qianfan/" class="">千帆镜像</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/chat-memory/" class="">聊天记忆</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/tool-calling/" class="">工具调用</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4a6f2545b8eeaf1b0914baa05363c5d4" class="toggle"  />
    <label for="section-4a6f2545b8eeaf1b0914baa05363c5d4" class="flex justify-between">
      <a href="../../docs/model-context-protocol-mcp/" class="">模型上下文协议 （MCP）</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/model-context-protocol-mcp/mcp-client-boot-starters/" class="">MCP 客户端启动启动器</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/model-context-protocol-mcp/mcp-server-boot-starters/" class="">MCP 服务器启动启动器</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/model-context-protocol-mcp/mcp-utilities/" class="">MCP 实用程序</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-14207920bac243191ad5fb9d8690ff76" class="toggle"  />
    <label for="section-14207920bac243191ad5fb9d8690ff76" class="flex justify-between">
      <a href="../../docs/retrieval-augmented-generation-rag/" class="">检索增强一代</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/retrieval-augmented-generation-rag/etl-pipeline/" class="">ETL 管道</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/model-evaluation/" class="">评估测试</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d4ad5a918cc2c26e8c350fe5d4f82af2" class="toggle"  />
    <label for="section-d4ad5a918cc2c26e8c350fe5d4f82af2" class="flex justify-between">
      <a href="../../docs/vector-databases/" class="">矢量数据库</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/azure-ai-service/" class="">Azure AI 服务</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/azure-cosmos-db/" class="">None</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/apache-cassandra-vector-store/" class="">Apache Cassandra 矢量存储</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/chroma/" class="">色度</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/couchbase/" class="">沙发基地</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/elasticsearch/" class="">None</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/gemfire/" class="">GemFire 矢量商店</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/mariadb-vector-store/" class="">MariaDB 矢量存储</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/milvus/" class="">米尔沃斯</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/mongodb-atlas/" class="">None</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/neo4j/" class="">新 4j</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/opensearch/" class="">开放搜索</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/oracle/" class="">Oracle Database 23ai — AI 向量搜索</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/pgvector/" class="">None</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/pinecone/" class="">松果</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/qdrant/" class="">None</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/redis/" class="">雷迪斯</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/sap-hana/" class="">None</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/typesense/" class="">Typesense 字体</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/vector-databases/weaviate/" class="">维维亚特</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/observability/" class="">可观察性</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/development-time-services/" class="">None</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/prompt-engineering-patterns/" class="">提示工程模式</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/building-effective-agents/" class="">Building Effective Agents</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/deploying-to-the-cloud/" class="">云绑定</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/testcontainers/" class="">测试容器</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/cohere/" class="">OCI GenAI Cohere 聊天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/text-embedding/" class="">Google VertexAI 文本嵌入</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../docs/multimodal-embedding/" class="">Google VertexAI 多模态嵌入</a>
  

        </li>
      
    
  </ul>










  
<ul>
  
  <li>
    <a href="https://github.com"  target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="../../svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>提示</h3>

  <label for="toc-control">
    
    <img src="../../svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#提示">提示</a>
      <ul>
        <li><a href="#api-概述">API 概述</a></li>
        <li><a href="#提示-1">提示</a></li>
        <li><a href="#消息">消息</a></li>
        <li><a href="#角色">角色</a></li>
        <li><a href="#提示模板">提示模板</a></li>
        <li><a href="#示例用法">示例用法</a></li>
        <li><a href="#使用自定义模板渲染器">使用自定义模板渲染器</a></li>
        <li><a href="#使用资源而不是原始字符串">使用资源而不是原始字符串</a></li>
        <li><a href="#快速工程">快速工程</a></li>
        <li><a href="#创建有效的提示">创建有效的提示</a></li>
        <li><a href="#简单的技术">简单的技术</a></li>
        <li><a href="#高级技术">高级技术</a></li>
        <li><a href="#microsoft-指南">Microsoft 指南</a></li>
        <li><a href="#令-牌">令 牌</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="提示">
  提示
  <a class="anchor" href="#%e6%8f%90%e7%a4%ba">#</a>
</h1>
<p>提示是指导 AI 模型生成特定输出的输入。这些提示的设计和措辞会显著影响模型的响应。
在 Spring AI 中与 AI 模型交互的最低级别上，在 Spring AI 中处理提示有点类似于在 Spring MVC 中管理“视图”。这涉及使用动态内容的占位符创建大量文本。然后，根据用户请求或应用程序中的其他代码替换这些占位符。另一个类比是包含某些表达式的占位符的 SQL 语句。
随着 Spring AI 的发展，它将引入更高级别的抽象来与 AI 模型交互。本节中描述的基础类在角色和功能方面可以比作 JDBC。例如，<code>ChatModel</code> 类类似于 JDK 中的核心 JDBC 库。<code>ChatClient</code> 类可以比作 <code>JdbcClient</code>，它构建在 <code>ChatModel</code> 之上，并通过 <code>Advisor</code> 提供更高级的构造
要考虑过去与模型的交互，请使用额外的上下文文档来增强提示，并引入代理行为。
随着时间的推移，提示的结构在 AI 领域内不断发展。最初，提示是简单的字符串。随着时间的推移，它们逐渐包括特定输入的占位符，例如 AI 模型可以识别的“USER：”。OpenAI 通过在 AI 模型处理之前将多个消息字符串分类为不同的角色，为提示引入了更多结构。</p>
<h2 id="api-概述">
  API 概述
  <a class="anchor" href="#api-%e6%a6%82%e8%bf%b0">#</a>
</h2>
<h2 id="提示-1">
  提示
  <a class="anchor" href="#%e6%8f%90%e7%a4%ba-1">#</a>
</h2>
<p>通常使用 <code>ChatModel</code> 的 <code>call（）</code> 方法，该方法采用 <code>Prompt</code> 实例并返回 <code>ChatResponse</code>。
<code>Prompt</code> 类充当一系列有组织的 <code>Message</code> 对象和请求 <code>ChatOptions</code> 的容器。每条 <code>Message</code> 在提示中都包含一个独特的角色，其内容和意图不同。这些角色可以包含各种元素，从用户查询到 AI 生成的对相关背景信息的响应。这种安排支持与 AI 模型进行复杂而详细的交互，因为提示是由多条消息构建的，每条消息都分配了在对话中扮演的特定角色。
下面是 Prompt 类的截断版本，为简洁起见，省略了构造函数和实用程序方法：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Prompt</span> <span style="color:#66d9ef">implements</span> ModelRequest<span style="color:#f92672">&lt;</span>List<span style="color:#f92672">&lt;</span>Message<span style="color:#f92672">&gt;&gt;</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> List<span style="color:#f92672">&lt;</span>Message<span style="color:#f92672">&gt;</span> messages;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> ChatOptions chatOptions;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="消息">
  消息
  <a class="anchor" href="#%e6%b6%88%e6%81%af">#</a>
</h2>
<p><code>Message</code> 接口封装了 <code>Prompt</code> 文本内容、元数据属性的集合和称为 <code>Message</code>Type 的分类。
接口定义如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Content</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	String <span style="color:#a6e22e">getContent</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMetadata</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Message</span> <span style="color:#66d9ef">extends</span> Content {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	MessageType <span style="color:#a6e22e">getMessageType</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>多模式消息类型还实现了 ```Media<code>Content` 接口，该接口提供了 </code>Media`` 内容对象列表。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MediaContent</span> <span style="color:#66d9ef">extends</span> Content {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Collection<span style="color:#f92672">&lt;</span>Media<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMedia</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>Message</code> 接口的各种实现对应于 AI 模型可以处理的不同类别的消息。模型根据对话角色区分消息类别。

  <img src="../../images/spring-ai-message-api.jpg" alt="" />
这些角色由 <code>MessageType</code> 有效地映射，如下所述。</p>
<h2 id="角色">
  角色
  <a class="anchor" href="#%e8%a7%92%e8%89%b2">#</a>
</h2>
<p>每条消息都分配有一个特定的角色。这些角色对消息进行分类，阐明 AI 模型提示的每个部分的上下文和目的。这种结构化的方法增强了与 AI 通信的细微差别和有效性，因为提示的每个部分在交互中都发挥着独特且定义的作用。
主要角色包括：</p>
<ul>
<li>System Role（系统角色）：指导 AI 的行为和响应风格，为 AI 如何解释和回复输入设置参数或规则。这类似于在开始对话之前向 AI 提供指令。</li>
<li>User Role：表示用户的输入 – 他们对 AI 的问题、命令或陈述。这个角色是基础，因为它构成了 AI 响应的基础。</li>
<li>Assistant Role（助理角色）：AI 对用户输入的响应。它不仅仅是一个答案或反应，它对于保持对话的流畅性至关重要。通过跟踪 AI 之前的响应（其“助理角色”消息），系统可确保连贯且与上下文相关的交互。Assistant 消息也可能包含函数工具调用请求信息。它就像 AI 中的一项特殊功能，在需要时用于执行特定功能，例如计算、获取数据或除交谈之外的其他任务。</li>
<li>工具/功能角色： 工具/功能角色 侧重于返回其他信息以响应工具调用助手消息。
角色在 Spring AI 中表示为枚举，如下所示</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">enum</span> MessageType {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	USER(<span style="color:#e6db74">&#34;user&#34;</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	ASSISTANT(<span style="color:#e6db74">&#34;assistant&#34;</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	SYSTEM(<span style="color:#e6db74">&#34;system&#34;</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	TOOL(<span style="color:#e6db74">&#34;tool&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="提示模板">
  提示模板
  <a class="anchor" href="#%e6%8f%90%e7%a4%ba%e6%a8%a1%e6%9d%bf">#</a>
</h2>
<p>Spring AI 中提示模板的一个关键组件是 <code>PromptTemplate</code> 类，该类旨在促进创建结构化提示，然后将其发送到 AI 模型进行处理</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PromptTemplate</span> <span style="color:#66d9ef">implements</span> PromptTemplateActions, PromptTemplateMessageActions {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Other methods to be discussed later</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>此类使用 <code>TemplateRenderer</code> API 来渲染模板。默认情况下，Spring AI 使用 St<code>TemplateRenderer</code> 实现，该实现基于 Terence Parr 开发的开源 [
  <a href="https://www.stringtemplate.org/">StringTemplate</a>](
  <a href="https://www.stringtemplate.org/">https://www.stringtemplate.org/</a>) 引擎。模板变量由 <code>{}</code> 语法标识，但您也可以将分隔符配置为使用其他语法。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">TemplateRenderer</span> <span style="color:#66d9ef">extends</span> BiFunction<span style="color:#f92672">&lt;</span>String, Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span>, String<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>	String <span style="color:#a6e22e">apply</span>(String template, Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> variables);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Spring AI 使用 <code>TemplateRenderer</code> 接口来处理变量到模板字符串的实际替换。默认实现使用 [
  <a href="../../#StringTemplate">[StringTemplate]。</a>](#StringTemplate) 如果您需要自定义逻辑，您可以提供自己的 <code>TemplateRenderer</code> 实现。对于不需要模板渲染的场景（例如，模板字符串已经完成），你可以使用提供的 NoOp<code>TemplateRenderer</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>PromptTemplate promptTemplate <span style="color:#f92672">=</span> PromptTemplate.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">renderer</span>(StTemplateRenderer.<span style="color:#a6e22e">builder</span>().<span style="color:#a6e22e">startDelimiterToken</span>(<span style="color:#e6db74">&#39;&lt;&#39;</span>).<span style="color:#a6e22e">endDelimiterToken</span>(<span style="color:#e6db74">&#39;&gt;&#39;</span>).<span style="color:#a6e22e">build</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">template</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Tell me the names of 5 movies whose soundtrack was composed by &lt;composer&gt;.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>String prompt <span style="color:#f92672">=</span> promptTemplate.<span style="color:#a6e22e">render</span>(Map.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;composer&#34;</span>, <span style="color:#e6db74">&#34;John Williams&#34;</span>));
</span></span></code></pre></div><p>此类实现的接口支持提示创建的不同方面：
<code>PromptTemplateStringActions</code> 侧重于创建和呈现提示字符串，表示提示生成的最基本形式。
<code>PromptTemplate``Message``Actions</code> 是为通过生成和作 <code>Message</code> 对象来创建提示而量身定制的。
```Prompt<code>TemplateActions` 旨在返回 </code>Prompt<code>对象，该对象可以传递给</code>ChatModel`` 以生成响应。
虽然这些接口可能在许多项目中没有广泛使用，但它们显示了创建提示的不同方法。
实现的接口包括</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">PromptTemplateStringActions</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	String <span style="color:#a6e22e">render</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	String <span style="color:#a6e22e">render</span>(Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> model);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>方法 <code>String render（）：</code> 将提示模板渲染为最终字符串格式，无需外部输入，适用于没有占位符或动态内容的模板。
方法 <code>String render(</code>Map&lt;String, Object&gt;<code> model)</code> ：增强渲染功能以包含动态内容。它使用 <code>Map&lt;String、Object&gt;</code>，其中映射键是提示模板中的占位符名称，值是要插入的动态内容。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">PromptTemplateMessageActions</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Message <span style="color:#a6e22e">createMessage</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Message <span style="color:#a6e22e">createMessage</span>(List<span style="color:#f92672">&lt;</span>Media<span style="color:#f92672">&gt;</span> mediaList);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Message <span style="color:#a6e22e">createMessage</span>(Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> model);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>方法 <code>Message</code> create<code>Message</code>（）： 创建一个不带额外数据的 <code>Message</code> 对象，用于静态或预定义的消息内容。
方法 ```Message<code> create</code>Message<code>(List&lt;Media&gt; mediaList)` ：创建具有静态文本和媒体内容的 </code>Message`` 对象。
方法 <code>Message createMessage(</code>Map&lt;String, Object&gt;<code> model)</code> ：扩展消息创建以集成动态内容，接受 <code>Map&lt;String， Object&gt;</code>，其中每个条目表示消息模板中的占位符及其相应的动态值。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">PromptTemplateActions</span> <span style="color:#66d9ef">extends</span> PromptTemplateStringActions {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Prompt <span style="color:#a6e22e">create</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Prompt <span style="color:#a6e22e">create</span>(ChatOptions modelOptions);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Prompt <span style="color:#a6e22e">create</span>(Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> model);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Prompt <span style="color:#a6e22e">create</span>(Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> model, ChatOptions modelOptions);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>方法 <code>Prompt</code> create（）： 生成一个没有外部数据输入的 <code>Prompt</code> 对象，非常适合静态或预定义的提示。
方法 ```Prompt<code>create(ChatOptions modelOptions)` ：生成一个</code>Prompt`` 对象，该对象没有外部数据输入，并且具有聊天请求的特定选项。
方法 <code>Prompt create(</code>Map&lt;String, Object&gt;<code> model)</code> ：扩展提示创建功能以包含动态内容，采用 <code>Map&lt;String， Object&gt;</code>，其中每个映射条目都是提示模板及其关联的动态值中的占位符。
方法 <code>Prompt create(</code>Map&lt;String, Object&gt;<code> model, ChatOptions modelOptions)</code> ：扩展提示创建功能以包含动态内容，采用 <code>Map&lt;String、Object&gt;</code>，其中每个映射条目都是提示模板中的占位符及其关联的动态值，以及聊天请求的特定选项。</p>
<h2 id="示例用法">
  示例用法
  <a class="anchor" href="#%e7%a4%ba%e4%be%8b%e7%94%a8%e6%b3%95">#</a>
</h2>
<p>下面显示了一个来自 [
  <a href="https://github.com/Azure-Samples/spring-ai-azure-workshop/blob/main/2-README-prompt-templating.md">PromptTemplates 上的 AI Workshop</a>](
  <a href="https://github.com/Azure-Samples/spring-ai-azure-workshop/blob/main/2-README-prompt-templating.md">https://github.com/Azure-Samples/spring-ai-azure-workshop/blob/main/2-README-prompt-templating.md</a>) 的简单示例。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>PromptTemplate promptTemplate <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PromptTemplate(<span style="color:#e6db74">&#34;Tell me a {adjective} joke about {topic}&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Prompt prompt <span style="color:#f92672">=</span> promptTemplate.<span style="color:#a6e22e">create</span>(Map.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;adjective&#34;</span>, adjective, <span style="color:#e6db74">&#34;topic&#34;</span>, topic));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> chatModel.<span style="color:#a6e22e">call</span>(prompt).<span style="color:#a6e22e">getResult</span>();
</span></span></code></pre></div><p>另一个示例摘自 [
  <a href="https://github.com/Azure-Samples/spring-ai-azure-workshop/blob/main/3-README-prompt-roles.md">AI Workshop on Roles</a>](
  <a href="https://github.com/Azure-Samples/spring-ai-azure-workshop/blob/main/3-README-prompt-roles.md">https://github.com/Azure-Samples/spring-ai-azure-workshop/blob/main/3-README-prompt-roles.md</a>) 如下所示。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>String userText <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Tell me about three famous pirates from the Golden Age of Piracy and why they did.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Write at least a sentence for each pirate.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Message userMessage <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> UserMessage(userText);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>String systemText <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  You are a helpful AI assistant that helps people find information.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  Your name is {name}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  You should reply to the user&#39;s request with your name and also in the style of a {voice}.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SystemPromptTemplate systemPromptTemplate <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SystemPromptTemplate(systemText);
</span></span><span style="display:flex;"><span>Message systemMessage <span style="color:#f92672">=</span> systemPromptTemplate.<span style="color:#a6e22e">createMessage</span>(Map.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;name&#34;</span>, name, <span style="color:#e6db74">&#34;voice&#34;</span>, voice));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Prompt prompt <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Prompt(List.<span style="color:#a6e22e">of</span>(userMessage, systemMessage));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Generation<span style="color:#f92672">&gt;</span> response <span style="color:#f92672">=</span> chatModel.<span style="color:#a6e22e">call</span>(prompt).<span style="color:#a6e22e">getResults</span>();
</span></span></code></pre></div><p>这显示了如何通过使用 System<code>Prompt</code>Template 创建一个 <code>Message</code> 来构建 <code>Prompt</code> 实例，其中<code>系统</code>角色传入占位符值。然后，带有角色 <code>user</code> 的消息将与角色<code>系统</code>的消息组合在一起以形成提示。然后将提示传递给 ChatModel 以获得生成响应。</p>
<h2 id="使用自定义模板渲染器">
  使用自定义模板渲染器
  <a class="anchor" href="#%e4%bd%bf%e7%94%a8%e8%87%aa%e5%ae%9a%e4%b9%89%e6%a8%a1%e6%9d%bf%e6%b8%b2%e6%9f%93%e5%99%a8">#</a>
</h2>
<p>您可以通过实现 <code>TemplateRenderer</code> 接口并将其传递给 <code>PromptTemplate</code> 构造函数来使用自定义模板渲染器。您也可以继续使用默认的 St<code>TemplateRenderer</code>，但使用自定义配置。
默认情况下，模板变量由 <code>{}</code> 语法标识。如果您计划在提示中包含 JSON，则可能需要使用不同的语法以避免与 JSON 语法冲突。例如，您可以使用 <code>&lt;</code> 和 <code>&gt;</code> 分隔符。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>PromptTemplate promptTemplate <span style="color:#f92672">=</span> PromptTemplate.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">renderer</span>(StTemplateRenderer.<span style="color:#a6e22e">builder</span>().<span style="color:#a6e22e">startDelimiterToken</span>(<span style="color:#e6db74">&#39;&lt;&#39;</span>).<span style="color:#a6e22e">endDelimiterToken</span>(<span style="color:#e6db74">&#39;&gt;&#39;</span>).<span style="color:#a6e22e">build</span>())
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">template</span>(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            Tell me the names of 5 movies whose soundtrack was composed by &lt;composer&gt;.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>String prompt <span style="color:#f92672">=</span> promptTemplate.<span style="color:#a6e22e">render</span>(Map.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;composer&#34;</span>, <span style="color:#e6db74">&#34;John Williams&#34;</span>));
</span></span></code></pre></div><h2 id="使用资源而不是原始字符串">
  使用资源而不是原始字符串
  <a class="anchor" href="#%e4%bd%bf%e7%94%a8%e8%b5%84%e6%ba%90%e8%80%8c%e4%b8%8d%e6%98%af%e5%8e%9f%e5%a7%8b%e5%ad%97%e7%ac%a6%e4%b8%b2">#</a>
</h2>
<p>Spring AI 支持抽象 `org.springframework.core.io.<code>Resource``` ，因此您可以将提示数据放在可以直接在 </code>PromptTemplate<code>中使用的文件中。例如，您可以在 Spring 托管组件中定义一个字段来检索</code>Resource``。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Value</span>(<span style="color:#e6db74">&#34;classpath:/prompts/system-message.st&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Resource systemResource;
</span></span></code></pre></div><p>然后将该资源直接传递给 <code>SystemPromptTemplate</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>SystemPromptTemplate systemPromptTemplate <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SystemPromptTemplate(systemResource);
</span></span></code></pre></div><h2 id="快速工程">
  快速工程
  <a class="anchor" href="#%e5%bf%ab%e9%80%9f%e5%b7%a5%e7%a8%8b">#</a>
</h2>
<p>在生成式 AI 中，创建提示是开发人员的一项关键任务。这些提示的质量和结构会显著影响 AI 输出的有效性。投入时间和精力来设计周到的提示可以大大改善 AI 的结果。
共享和讨论提示是 AI 社区的常见做法。这种协作方法不仅创造了一个共享的学习环境，而且还导致了高效提示的识别和使用。
该领域的研究通常涉及分析和比较不同的提示，以评估它们在各种情况下的有效性。例如，一项重要研究表明，以“深呼吸并逐步解决这个问题”开始提示会显著提高解决问题的效率。这凸显了精心选择的语言对生成式 AI 系统性能的影响。
掌握最有效地使用提示，尤其是在 AI 技术快速发展的情况下，是一项持续的挑战。您应该认识到提示工程的重要性，并考虑使用来自社区和研究的见解来改进提示创建策略。</p>
<h2 id="创建有效的提示">
  创建有效的提示
  <a class="anchor" href="#%e5%88%9b%e5%bb%ba%e6%9c%89%e6%95%88%e7%9a%84%e6%8f%90%e7%a4%ba">#</a>
</h2>
<p>在开发提示时，重要的是要集成几个关键组件以确保清晰度和有效性：</p>
<ul>
<li>说明 ：向 AI 提供清晰直接的指示，类似于您与人交流的方式。这种清晰度对于帮助 AI “理解” 预期内容至关重要。</li>
<li>外部背景 ：必要时包括 AI 响应的相关背景信息或具体指导。这个 “外部上下文” 构建了提示并帮助 AI 掌握整体场景。</li>
<li>用户输入 ：这是简单的部分 - 用户的直接请求或问题构成了提示的核心。</li>
<li>输出指示器 ： 这方面可能很棘手。它涉及为 AI 的响应指定所需的格式，例如 JSON。但是，请注意，AI 可能并不总是严格遵守此格式。例如，它可能会在实际 JSON 数据之前预置“here is your JSON”之类的短语，或者有时会生成不准确的类似 JSON 的结构。
在制作提示时，向 AI 提供预期问答格式的示例可能非常有益。这种做法有助于 AI “理解” 查询的结构和意图，从而获得更精确和相关的响应。虽然本文档没有深入探讨这些技术，但它们为进一步探索 AI 提示工程提供了一个起点。
以下是用于进一步调查的资源列表。</li>
</ul>
<h2 id="简单的技术">
  简单的技术
  <a class="anchor" href="#%e7%ae%80%e5%8d%95%e7%9a%84%e6%8a%80%e6%9c%af">#</a>
</h2>
<ul>
<li>将大量文本缩减为简洁的摘要，捕捉关键点和主要思想，同时省略不太关键的细节。</li>
<li>侧重于根据用户提出的问题从提供的文本中得出特定答案。它是关于精确定位和提取相关信息以响应查询。</li>
<li>系统地将文本分类为预定义的类别或组，分析文本并根据其内容将其分配到最合适的类别。</li>
<li>创建交互式对话，AI 可以在其中与用户进行来回通信，模拟自然的对话流。</li>
<li>根据特定的用户要求或描述生成功能代码片段，将自然语言指令转换为可执行代码。</li>
</ul>
<h2 id="高级技术">
  高级技术
  <a class="anchor" href="#%e9%ab%98%e7%ba%a7%e6%8a%80%e6%9c%af">#</a>
</h2>
<ul>
<li>使模型能够做出准确的预测或响应，只需最少或没有特定问题类型的先前示例，即可使用学习的泛化理解新任务并采取行动。</li>
<li>链接多个 AI 响应以创建连贯且上下文感知的对话。它帮助 AI 维护讨论的主线，确保相关性和连续性。</li>
<li>在这种方法中，AI 首先分析（推理）输入，然后确定最合适的行动方案或响应。它将理解与决策相结合。</li>
</ul>
<h2 id="microsoft-指南">
  Microsoft 指南
  <a class="anchor" href="#microsoft-%e6%8c%87%e5%8d%97">#</a>
</h2>
<ul>
<li>Microsoft 提供了一种结构化的方法来开发和优化提示。该框架指导用户创建有效的提示，从 AI 模型中引出所需的响应，优化交互以提高清晰度和效率。</li>
</ul>
<h2 id="令-牌">
  令 牌
  <a class="anchor" href="#%e4%bb%a4-%e7%89%8c">#</a>
</h2>
<p>令牌在 AI 模型处理文本的方式中至关重要，它充当将单词（正如我们理解的）转换为 AI 模型可以处理的格式的桥梁。这种转换分两个阶段进行：单词在输入时转换为词元，然后在输出中将这些词元转换回词。
分词化是将文本分解为分词的过程，是 AI 模型理解和处理语言的基础。AI 模型使用这种标记化格式来理解和响应提示。
为了更好地理解标记，请将它们视为单词的一部分。通常，一个标记表示大约四分之三的单词。例如，莎士比亚全集总计约 900,000 字，可翻译成约 120 万个代币。
尝试使用 [
  <a href="https://platform.openai.com/tokenizer">OpenAI Tokenizer UI</a>](
  <a href="https://platform.openai.com/tokenizer">https://platform.openai.com/tokenizer</a>)，看看单词是如何转换为标记的。
除了在 AI 处理中的技术作用之外，令牌还具有实际意义，尤其是在计费和模型功能方面：</p>
<ul>
<li>计费：AI 模型服务通常根据 Token 使用情况计费。输入 （prompt） 和输出 （response） 都会计入总令牌计数，因此较短的提示更具成本效益。</li>
<li>模型限制：不同的 AI 模型具有不同的令牌限制，定义了它们的“上下文窗口”——它们一次可以处理的最大信息量。例如，GPT-3 的限制为 4K 令牌，而 Claude 2 和 Meta Llama 2 等其他模型限制为 100K 令牌，一些研究模型最多可以处理 100 万个令牌。</li>
<li>Context Window：模型的 Token 限制决定了其 Context Window。模型不会处理超过此限制的输入。仅发送最少的有效信息集进行处理至关重要。例如，在查询“哈姆雷特”时，无需包含莎士比亚所有其他作品中的标记。</li>
<li>响应元数据：来自 AI 模型的响应元数据包括使用的令牌数量，这是管理使用和成本的重要信息。</li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#提示">提示</a>
      <ul>
        <li><a href="#api-概述">API 概述</a></li>
        <li><a href="#提示-1">提示</a></li>
        <li><a href="#消息">消息</a></li>
        <li><a href="#角色">角色</a></li>
        <li><a href="#提示模板">提示模板</a></li>
        <li><a href="#示例用法">示例用法</a></li>
        <li><a href="#使用自定义模板渲染器">使用自定义模板渲染器</a></li>
        <li><a href="#使用资源而不是原始字符串">使用资源而不是原始字符串</a></li>
        <li><a href="#快速工程">快速工程</a></li>
        <li><a href="#创建有效的提示">创建有效的提示</a></li>
        <li><a href="#简单的技术">简单的技术</a></li>
        <li><a href="#高级技术">高级技术</a></li>
        <li><a href="#microsoft-指南">Microsoft 指南</a></li>
        <li><a href="#令-牌">令 牌</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












